(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{190:function(t,s){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAjgAAAB9CAIAAAAgHY5XAAAAA3NCSVQICAjb4U/gAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAW1UlEQVR4nO3df0wb5/0H8M9BUpw0hPJN1wBNtpHN163KJkSTJrBFmrpW6mKUbdDQYrvLxKao2tqOTlmnNAQDMdWyVY0l1GlTtSYE20QwiKL6skzb+CNMmPwAbVqlNHddyBQKbN2gKT8anMB9/zj/ONvn8/n3pX2/xD/cPfc8n3ts7uPnuecMMzH1AcW2/t57711nWL6zcofy79wWiREXPpqbW5hfWV4hYlatzi8sWr+mYA0xzD2rGUZcXrUqb2H+1kcLCyp16sSDJffnOgSAhL0//d9chwCQbavUd3+0sDC3uFhUuHbtGsMdZkUk5p771xf9X6FIJIqUx1B+HkOiyNDKqvy8hY99/51ZFEUxO6EDAMCnQZxERUSiKH740cLszXlDwT0GQ8E9q/JX5+fl5+UR0fLKysrysu/O8q1bS7eWfAzDZD5gAAD4dImfqCQMwyz5bi/5bqsUSFNIAAAAIQxm6gAAQM/ych0AAACAGiQqAADQNSQqAADQNSQqAADQNa2r/gAyShTFj2/57iwvr6ys5DoWANAXJCrIPVEU5+YXV7AAFQCUYOoPcu/jWz5kKQCIBYkKcu/O8nKuQwAA/UKigtzDfSkAUIFEBQAAuoZEdZd55513RkdHs9yoz+ezWq0+ny/L7QIAUBpX/fl8vsnJyc9//vPpqjCW69evP/DAA2vXrs10QxEEQejt7R0aGpqcnMzPz9+8efPOnTvNZnMWTjnI7XZ3d3fn5eU9+eSTL7zwQtbaPXPmjNfr9Xg8tbW1WWsUAECSnhGVz+fjeX7dunVpqU1dYWHh1atXFxcXs9CW5Pbt262trfX19evXrz927NjIyMj58+dfffVVg8Hw9NNP/+IXvxAE4fXXX890GL///e+PHz/e3d198uRJj8fz5ptvZrrFoK6urn379p08eTJrLSaKt1UWFxUWF1W28cSZC4u3tfBERMSZCx+18QlX53mmuOgZTtuWQNOBn0DTmqpNDN+2TcPpeJ4pLnqmzawQCWcuLDZ7km9fVn8KZ5FdKUWr1uHytxan1Nvq8SRwiDwgW2USR8kl+ReRxQoVpWFEJWWpkpKS++/Pxv/M3bBhAxFdvXr1oYceysK46vbt242NjUTEcVxZWVlw+9atW7du3frDH/7w+eef7+rqMhgML7zwwurVqzMUxpkzZ37zm9+4XC6pk7u7uxsaGgwGw7PPPpuhFoMuXLjg8/mam5sff/zxsbGxysrKTLeYML7F6qCmS3M2logo5Wso39bKGZtGTdq28ERk6pl11yRebSb4W7FtJ4eFF4jY0C6Pm6Pdrrhxaqo/w2eRLnqLNhSPDjM9b6vcwdVcuNzOxi+bbakmqixnKUk2c1VHRwcRdXd3K+793//+JwiCz+fz+Xznz5//5je/mYkYOI5zOBwul2vjxo3SlgceeEDKVQUFBfX19ZloNOjEiRP79u3Ly8v73ve+19XVpctExQvEbgv8eZncc7Mp1ebkBKPJwia2JYlqMyHYCmvdTQ1uD5mCicnjPEsmZ6p5KitnkS7ZilbrW04WT6rv0k+ZlKb+cpKlJBs2bPjsZz+b6TlAQRDOnDlz9OjRWAXefvvt4D/08nhSnlRR8sc//vGXv/xld3e3fDxHRGVlZU6ns7Oz88yZM5loVzIxMXHx4kXp1lRdXd3Q0NC///3vzDWXBN5WWWzhiDhrYNpNZYJLNk0XmA7yPFNcVGiRFeddHsFY08AmtiVS7GrDwuNbHpUV422VwV0KoQZw5pjTjLLAaswmOusORcC5OTJZTUTRM1oRPabStKx+qRJP2zZ/MBaP/3TkB0ZMcKnOXPHBqmRl/KEqnbLKrljRqtUTqzfUOzyhDpS/beSHSLNnsVoJbY96V0c3xNsqpQnwUJcq/S1EtcW3bSvc4RBIOLbD35Cm1zdrkk9UOcxSkizkqt7e3sbGxogMIffiiy+OjIz09/c/99xz169fX1paSm8Ag4ODHR0dXV1dmzZtit67efPmkydPHj169A9/+EPqbb3//vsVFRVbwz3xxBP19fVr1qwhosLCwj179nzjG9+IKFNRUTE5OZl6AMlh28ZmXSYik/Pm3KzqrIV/ZuPm3OzNuQtNvFX5j83T5hB2t8rr0bIlrtAhJrOJOKe/aZ4XKJhO+B5OMBpZ9VAFxyNu89zszbnZm6NNdGxH2GUoLLCwhqR5P3P88ZRqL0WeuOBoIbdU0njWUli8nbdJgRk5q9njj0Hw9ASumz2cYDRZFfuNt/mrij4vlVPW3hvxCseU6FG8rXKHg3XelA6xXg6lQLW3jayVnt3CMavs7peVM/lrMzt3OISwhqJeKbbtVJNRcLR6iIg8LQ7B5IyalFZqi7VdnrvQZCTjSxduzgXnseO+vlmTZKLKeZaSZDpXDQ0NPf7443GLVVRU/OxnPzt9+nRBQUEaWz9//vz+/ftPnDihsrCwvLz8+PHjL7744uDgYIrNPfjgg52dnQaD4eWXX74YMDo6euDAgWCZw4cPj46OBve+/PLLBQUFnZ2dKrlcNzxtDmpy+y8TbFv7buLcHqKaU7M351zh82Nh13MtW7iG4GIK/2dzlWpZ1kj8ZZ6IiHNzRqOR+IvSp1rePy8UI1SJqSdQLWtrNRHX0sYrtUJENdbdgYaIvyhExJxQL8U6cVO7dF+QtdQYiXa7TplCgTk5fwwC74/ByQkmW5tyfmfbTtn8e9gGU7BPok7Z/ZJRfsoquxSijV1YhUqHK/C0OYRAPxBRTeh8o+NRbqXG1mQUOCdPFLitGKit5pQzdLct1isVPDWPxcLJIonblmJU8V7fbEkmUekkS0kymqsmJyc/97nPpb1aLYaHh1955ZV169Zt2bJFvaR0o+7gwYN//etfU2x0165dvb29XV1dDofDYDCsXbt27dq1+fn5wQL5+fnSRoPB4HA4urq6+vr6du3alWK72eBxniXBsT24PK/hrFIp2fxYAlvI1DPr/wQ9d1HpQhx2CGs1GQXOxRPxl3mjyd2+WxpzeJxnpXkh1VClIZcfyxrVAmNZf0PEuzxCRMyKVJuOPvFQMOyj8khkamxNRmnIKIvBYwmtkwyN2ILzUfJxQ+Qph1PZpRZtIlQ6XEHsbKTwtokbW1RtRqNRtivGK8W220yCY3vD2VBC0tCWelQxX98sSSZR3bhx47777tNDlpJs2LBh48aN169fz2EMS0tLaZl/Czp27Nibb76Zl6fpBcrPz//tb3/7q1/9KvV2t2zZcvr06StXruzfv39+fl6xzPz8/P79+69cuXL69Om4eVRPAlMogZ/IP2O+pY0zNrXWJLYlrshD2AaTURB44p2cwG5jWdYo8Dzxl3hiHw2uCIkTavxWAg1xTp74Hk7QMu+n1nQSJy4FYakxck4uLIYaV6j+U8HUZSV/vr/QlPJVMdloMyUj8cR8k4Ty2SdFMolq48aNMzMzsa5i2bewsDA9PV1aWpr2msvKyv71r39pKXnt2rWDBw+msem+vr4vf/nL2stXVFSka1XF+vXrT5w4UVZW9tRTT0XfdVtaWnrqqafKyspOnDixfv36tLSYDSxrlM9iKUnPMgoN1fqv3TwvmKwmYhtMxrNujyAEruOqoQqCbJ5GttxRMTDWUmMUPD0eJydomfdTazqJEw/UaTUZObdNNQZpRWKMJf6xTllll2K0KvWoSOwo2byuXJK9F1WbIAiyXTHeJNLTGq6XjFyDJas3kjIomUQlzUddu3ZND7lqYWHh6tWr5eXlxcXFaa/861//+p///GctJf/yl79Yrda0B5Ar+fn5P/rRj2ZmZqLvuhUUFMzMzDz33HPyKcG7ANtuM9FZS3CiyWOR1juFludF3+rXsiUGtWqliRS+rZWTMhNrqTHyLW1c8CZWjFAloauPx2LhjE3tJpXApGnG1oh5P7bBZBQcLcF1j9bg7FvMpjWfuAK2wWQ86zimNvcov+zyLdbwqb8Yp6yyK0a0yoVj90bc1hVORJp2C3Qg32Kx8cn3Hms1GQWH2f/q87ZKLa9Um/mYYGq31bQ7m4xnW1t4ilxcGrO17SwJvBCnVG4k+RxVMFdt2bIlO19IoSijWYqInn766fr6+rq6OvXFAlNTU93d3W+//XYmYsiVv/3tb1/96lcVd23btu3SpUvf/va3sxxSikzuOae50FpUKP3mvHkq7MIhLZGS32HSskXCNRQXBX8xNl0as8U5pMZsarByJps/Mz1qFI6dNYWugCqhGpt62NbCYou0p2dWqjlWYMQ2mIwOh7A7fNKJbTvVxD3ir9/U4zRxwQ9Zyk3HrF8Ttq19t6OFVZn4YtudTZ4dlsJiIjK+5GwyyrOF8imr7IoRbax6VHpDvXVFYR1ofOnCZZY8zyTbe6zt8ihte2RH0TGp9QtNLTsCPaP4SnHmRxyCyXm5hvzd3rDD/Ohsq7bWatqbjI9YiwrJ1DPr1tejcoyYwj+sm5+fz2GuynSWkrS2tv7zn/+M9cAvEYmiaLFYtm7d+sorr6S99crKyrGxsXQVS8jRo0fvvffe559/noiGh4cdDsdPfvKTr33ta0R0/Pjxa9euHTlyJF1tffhR7ofmnLnQSmFfMKFlSxLVZkKmW0mx/hS+8oBv2/YIZxpVWqISc5dStCr1ZFx23gOfbCk98JvDOcDsZCkiOnToEBE9++yzio8KTU5ONjY2fuYzn0nvDSo9+Pvf/15RUbG0tGS32w8cOPDkk0/+/Oc/b25unp+f3759+6VLl3IdYFrxLW0Rjxlp2ZJEtZmQ6VZSrT+Jx85SkJ0+105v8dydUv1S2pzkqqxlKSJavXr1W2+99YUvfMFkMnV2dl65cmVxcXFxcfHdd9/t7Oz8zne+8/DDD7/22msMw2Q6kmwSRfGdd97Jy8vbs2fPf/7zn3PnzjU2Np47d255eflb3/rWzMzM1NTUhx9+mOsw04dtvxixsk7LliSqzYRMt5JC/Zy5sLgo5jrpjMhOn2unt3juTilN/QVlcw4wm1lKTv5vPgwGA8uyDz/88Pe///2MPuva2Nio5UsfysrK3nrrrTS2e/Xq1Zqamvvuu+/w4cN79uyR7xoaGjp48OAHH3zw61//Ol3fbaiHqT8A0K30JCoimp+fn5iY+NKXvpSW2lS8++67GzduzHKW+rQ5d+5cT0/P0aNHS0pKovfOz8+/+uqrDz300L59+9LSHBIVAKhIW6ICSNpH84srKyu5jgIAdAr/ih5yb9Xd9UgWAGQXEhXk3hrDPXmfrNUoAJBGmPoDXRBF8eNbvjvLy5gDBIAISFQAAKBrmPoDAABdQ6ICAABdQ6ICAABdQ6ICAABdWzU7O5vrGAAAAGLCqj8AANA1TP0BAICuIVEBAICuIVEBAICuIVEBAICuIVEBAICuIVEBAICuIVEBAICuIVEBAICuIVEBAICuIVEBAICuIVEBAICuIVEBAICuIVEBAICuIVEBAICuIVEBAICuIVEBAICuIVEBAICuIVEBAICuIVEBAICu5S5RTbjrGKauZ/rT1bROjHQwDNMxkuswAAA0uFtGVN6OzKWWCXddylft6Z46hunwhm3zdjB17olQEXc9wxzxRh6ZSCPueoapd2c7waajfwAAkrYqZy1vMveLZq2FJ8bHMhfJxPgAUWVKNbh/bCbXjUNVgV/rNlsGiIhqXaFCJebe4XGmuu6LU/0NJUm1MtjfR3avOamDw+08JIqHNLebcv8AAKTgbhlR6Zr3uGWg/YB5ExFJWWr8gChOuWujClYd8toHzL9LblQ1PdQ/QPbHdqYUKgDA3UdM3rA9WEv7sHyH7Bpd67ohiqIoeu1EZPf6D7F7RfGGq5ao1j0lHeHaS7TXNXXDVRtV53B7WMCBQ7SFKDvW7g1sDTU95dobVnmojDd0crKz88c5LJ3gXteUv7bAaUZ2QvT2Ybu8lQQM28POPbXO928J6w15Zg1EGLt/AACyJYERlfeI/BaLt4OpHgteN58YD9yMmXbXM6XmysC18w0aCo0fmqteK78hiqJ4SHFY0Gcp/Sm9IR3ntVNLtXRTqupwWFYLzJtNu+vj3DiZ7qkbfMIfx5S7trlKfsdIUmLuDbtq+wMb6WCqmgMX5WF7S3XYvaU+S/V7B0RRFHvNJdJAZ2/dY5s09mLVY+3U/Ce1MVV4PweMDDZTbd0u6dzT3/kD5tIfB/p+uJ0CfRWjfzR0PgBA2mhIZsEP77LxgfwjuUyMYYS/fNhgKHpERXb50GDKXRvaElZYXoCIAiMbDWfhryGitshzGbZT2DBFFolCnMPtkWMa2VExRlrKASv1c+Ag/4hTOeA4LSp0ftSIKvwUplx7ZVuUmkuw8wEAkqc2opruqWMYhgl9eO83B8cNm8priZqrIta50fh7AxR7eFFZrroOYG95uey3kvJKorHxyDGQrEBDvyiKojjlIkspwzBM9IApYMJdx1Q3Ew28N64WgGRksJnI/kRVzEjC4pwe/wfVfrGcNCspr6S+cXkcav3sj3+wv4/sPw0so8hA54efQkn5V4j+Ma6yvDCBzgcASE3MROU9wpSaB6TP0Qqr1DaZ+712oubqsIvU9Pg/iL6ino4SMqCSqAJKzL2iKIpTbrJsDlvC7j3C+P2U3pDf1NGguYoJqWrWFkky4vSzVOa4JWwZRXY6PzybxhCz8wEA0iVmoqo6LN3XYRgmxrM7Ow+JojRxNGDZLLtjofpJPEG15fHv/Xg7GIZhmFIzuW7IrvUjHdUtgQmr3kSXdCtMoCnfV0tZ/H4m72AL1bp/UCXfloXODx/gxhCj8wEA0kdt6i8wvTNs74s9vbPJ3C8O24nGxqeJSh77bi319Q8mN/gI/wjv/VOzykQWyWbMmv23ScJmzKbHx8LynPYnsXY+ZqeB/iGNF/yS8q9om1GUBxYxyanaz9M9r8mWUYRLX+eHn4J3sIVqv/uYStpR73wAgDTSsuqv6pB0HW0fsBwP3BYZ6Qh9ip8YHwvcAilpOGCnAcvm4O2TaXeP9qeGmqsDq92me+qqW8LuylRGXkynB08PqAyYSnbV1YbyjbfD/wSukk3ltf5rvf98f+CuHTCXhk5wpEPlGyXKv1ib0Dhm/L2BGBN0Sv1M04OnByj4kFYgnvR3fkt1oM5pd311M9kPBIdHkf1DcTsfACCdkl6GofyIknSDPfTwTcSjPLJSSs9RDSs8yhMQeLBJ+3NU4U8UydbyRa0hDJYMNhr2uG7Uc1RhEUQ8RyV/FCwodEiCz1HdcNUqlU+18xWeoxqWHWiPWMUY3T8AAFnDiKKoNadl0LS7vtRCrqm78uP5tLu+tP+72r4YaaSDqaJh8VBV/KJERN4jTHWLXXv5ZEy46zZbyJ3sFzsBAGQYvkIpdSXm111k/rGG9dnT7tebI5dFqJhwvxa9jAIA4FMmd19K+0myyfyGu790c0e52tAnMGrUPnBJ6Ht7AQA+oZCo0qOkoV9siFPE3Iu0AwCQMJ3cowIAAFCGe1QAAKBrSFQAAKBrSFQAAKBrSFQAAKBrSFQAAKBrSFQAAKBrSFQAAKBrSFQAAKBrSFQAAKBrSFQAAKBrSFQAAKBrSFQAAKBrSFQAAKBrSFQAAKBrSFQAAKBrSFQAAKBrSFQAAKBrSFQAAKBrSFQAAKBrSFQAAKBrSFQAAKBrSFQAAKBrSFQAAKBrSFQAAKBrSFQAAKBrSFQAAKBrSFQAAKBrSFQAAKBrSFQAAKBrSFQAAKBrSFQAAKBrSFQAAKBrSFQAAKBrSFQAAKBrSFQAAKBrSFQAAKBrSFQAAKBrSFQAAKBrSFQAAKBrSFQAAKBrSFQAAKBrSFQAAKBrSFQAAKBrSFQAAKBr/w+MDWtxNfmjIQAAAABJRU5ErkJggg=="},191:function(t,s,a){t.exports=a.p+"assets/img/html-entity.84d7e4bf.png"},192:function(t,s,a){t.exports=a.p+"assets/img/csp.2f06f628.png"},299:function(t,s,a){"use strict";a.r(s);var r=a(6),e=Object(r.a)({},(function(){var t=this,s=t.$createElement,r=t._self._c||s;return r("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[r("h1",{attrs:{id:"xss-跨站脚本攻击"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#xss-跨站脚本攻击"}},[t._v("#")]),t._v(" XSS （跨站脚本攻击）")]),t._v(" "),r("p",[t._v("有用户输入的地方就有可能发生XSS攻击。")]),t._v(" "),r("h2",{attrs:{id:"xss分类"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#xss分类"}},[t._v("#")]),t._v(" XSS分类")]),t._v(" "),r("ol",[r("li",[t._v("反射型。通过URL参数直接注入。")]),t._v(" "),r("li",[t._v("存储型。存储到DB后读取时注入。")])]),t._v(" "),r("h3",{attrs:{id:"反射型"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#反射型"}},[t._v("#")]),t._v(" 反射型")]),t._v(" "),r("p",[t._v("对于反射型的XSS，通常通过短网址类来传播。")]),t._v(" "),r("p",[t._v("例如带有script的url： http://abc.com?from=<script>alert(1)<\/script>")]),t._v(" "),r("p",[t._v("生成短网址后可能为 https://4m.cn/c69o6")]),t._v(" "),r("p",[t._v("生成短网址网站有 https://4m.cn/")]),t._v(" "),r("h3",{attrs:{id:"存储型"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#存储型"}},[t._v("#")]),t._v(" 存储型")]),t._v(" "),r("p",[t._v("存储型的xss危害更大，因为传播时不用改变url。\n通过评论啊，留言啊之类的写入数据库。")]),t._v(" "),r("h2",{attrs:{id:"xss-攻击注入点"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#xss-攻击注入点"}},[t._v("#")]),t._v(" XSS 攻击注入点")]),t._v(" "),r("ol",[r("li",[t._v("HTML节点内容")]),t._v(" "),r("li",[t._v("HTML属性")]),t._v(" "),r("li",[t._v("JavaScript代码")]),t._v(" "),r("li",[t._v("富文本")])]),t._v(" "),r("h3",{attrs:{id:"html节点内容注入"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#html节点内容注入"}},[t._v("#")]),t._v(" HTML节点内容注入")]),t._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[t._v("<div>\n  #{content}\n</div>\n")])])]),r("p",[t._v("如果content的值是 <script>alert(1)<\/script>\n则在页面上显示")]),t._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[t._v("<div>\n  <script>alert(1)<\/script>\n</div>\n")])])]),r("h3",{attrs:{id:"html属性注入"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#html属性注入"}},[t._v("#")]),t._v(" HTML属性注入")]),t._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[t._v('<img scr="#{image}"/>\n')])])]),r("p",[t._v('如果 image的值是 "1 onerror="alert(1)\n则在页面上显示')]),t._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[t._v('<img scr="1" onerror="alert(1)"/>\n')])])]),r("h3",{attrs:{id:"javascript代码注入"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#javascript代码注入"}},[t._v("#")]),t._v(" JavaScript代码注入")]),t._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[t._v('<script>\n    var data = "#{data}";\n<script/>\n')])])]),r("p",[t._v('如果 data 的值是 hello";alert(1);"\n则在页面上显示')]),t._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[t._v('<script>\n    var data = "hello";alert(1);"";\n<script/>\n')])])]),r("h3",{attrs:{id:"富文本注入"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#富文本注入"}},[t._v("#")]),t._v(" 富文本注入")]),t._v(" "),r("p",[t._v("由于富文本就是带有格式的HTML，因此风险更高。")]),t._v(" "),r("h2",{attrs:{id:"xss防御"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#xss防御"}},[t._v("#")]),t._v(" XSS防御")]),t._v(" "),r("ol",[r("li",[t._v("浏览器自带防御")]),t._v(" "),r("li",[t._v("代码中防御")]),t._v(" "),r("li",[t._v("CSP 内容安全策略")])]),t._v(" "),r("h3",{attrs:{id:"浏览器自带防御"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#浏览器自带防御"}},[t._v("#")]),t._v(" 浏览器自带防御")]),t._v(" "),r("p",[t._v("一些浏览器可以防御反射型并通过HTML内容和属性注入的脚本.")]),t._v(" "),r("h3",{attrs:{id:"代码中防御"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#代码中防御"}},[t._v("#")]),t._v(" 代码中防御")]),t._v(" "),r("p",[t._v("对于HTML节点内容注入，HTML属性注入，JavaScript代码注入的防御，")]),t._v(" "),r("p",[t._v("就是通过转义 &, <, >, \", ' 为HTML实体实现的。")]),t._v(" "),r("p",[t._v("对 & 的转义必须放在第一")]),t._v(" "),r("div",{staticClass:"language-js extra-class"},[r("pre",{pre:!0,attrs:{class:"language-js"}},[r("code",[r("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("escapeHtml")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),r("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("str")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),r("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("str"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),r("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  str "),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" str"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),r("span",{pre:!0,attrs:{class:"token function"}},[t._v("replace")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),r("span",{pre:!0,attrs:{class:"token regex"}},[r("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")]),r("span",{pre:!0,attrs:{class:"token regex-source language-regex"}},[t._v("$")]),r("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")]),r("span",{pre:!0,attrs:{class:"token regex-flags"}},[t._v("g")])]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token string"}},[t._v("'&amp;'")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  str "),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" str"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),r("span",{pre:!0,attrs:{class:"token function"}},[t._v("replace")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),r("span",{pre:!0,attrs:{class:"token regex"}},[r("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")]),r("span",{pre:!0,attrs:{class:"token regex-source language-regex"}},[t._v("<")]),r("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")]),r("span",{pre:!0,attrs:{class:"token regex-flags"}},[t._v("g")])]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token string"}},[t._v("'&lt;'")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  str "),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" str"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),r("span",{pre:!0,attrs:{class:"token function"}},[t._v("replace")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),r("span",{pre:!0,attrs:{class:"token regex"}},[r("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")]),r("span",{pre:!0,attrs:{class:"token regex-source language-regex"}},[t._v(">")]),r("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")]),r("span",{pre:!0,attrs:{class:"token regex-flags"}},[t._v("g")])]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token string"}},[t._v("'&gt;'")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  str "),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" str"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),r("span",{pre:!0,attrs:{class:"token function"}},[t._v("replace")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),r("span",{pre:!0,attrs:{class:"token regex"}},[r("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")]),r("span",{pre:!0,attrs:{class:"token regex-source language-regex"}},[t._v('"')]),r("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")]),r("span",{pre:!0,attrs:{class:"token regex-flags"}},[t._v("g")])]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token string"}},[t._v("'&quto;'")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  str "),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" str"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),r("span",{pre:!0,attrs:{class:"token function"}},[t._v("replace")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),r("span",{pre:!0,attrs:{class:"token regex"}},[r("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")]),r("span",{pre:!0,attrs:{class:"token regex-source language-regex"}},[t._v("'")]),r("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")]),r("span",{pre:!0,attrs:{class:"token regex-flags"}},[t._v("g")])]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token string"}},[t._v("'&#39'")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),r("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" str"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),r("p",[t._v("转义为HTML实体后，上面的 <, >, &, \", ' 就会只显示他们自己。")]),t._v(" "),r("p",[t._v("比如")]),t._v(" "),r("div",{staticClass:"language-jsx extra-class"},[r("pre",{pre:!0,attrs:{class:"language-jsx"}},[r("code",[r("span",{pre:!0,attrs:{class:"token tag"}},[r("span",{pre:!0,attrs:{class:"token tag"}},[r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("p")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),r("span",{pre:!0,attrs:{class:"token plain-text"}},[t._v("&ltscript&gtalert(1)&lt/script&gt")]),r("span",{pre:!0,attrs:{class:"token tag"}},[r("span",{pre:!0,attrs:{class:"token tag"}},[r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("p")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),r("p",[t._v("页面展示为下面，不会弹出alert")]),t._v(" "),r("p",[r("img",{attrs:{src:a(190),alt:"html实体"}})]),t._v(" "),r("p",[r("img",{attrs:{src:a(191),alt:"html实体"}})]),t._v(" "),r("p",[t._v("对于通过富文本注入的，通常通过白名单或者第三方库防御。")]),t._v(" "),r("p",[t._v("原理是：")]),t._v(" "),r("ol",[r("li",[t._v("定义允许输入的标签，属性的白名单。")]),t._v(" "),r("li",[t._v("使用cheerio先解析用户输入的HTML")]),t._v(" "),r("li",[t._v("遍历每个标签，属性，如果不在白名单里则删除。")]),t._v(" "),r("li",[t._v("返回过滤后的HTML")])]),t._v(" "),r("h2",{attrs:{id:"csp"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#csp"}},[t._v("#")]),t._v(" CSP")]),t._v(" "),r("p",[t._v("CSP是http的头属性 Content-Security-Policy\n作用就是指定哪些内容可以执行。")]),t._v(" "),r("p",[r("img",{attrs:{src:a(192),alt:"csp"}})]),t._v(" "),r("p",[t._v("左边定义的是可执行内容的类型。")]),t._v(" "),r("p",[t._v("右边定义的是防御的策略。")]),t._v(" "),r("p",[t._v("例如 "),r("code",[t._v("script-src 'self'")]),t._v("的意思是：只能执行同域下的脚本。")]),t._v(" "),r("p",[t._v("script-src指定 要执行的内容为script脚本")]),t._v(" "),r("p",[t._v("self指定 只能是同域下的可以执行。")]),t._v(" "),r("p",[t._v("default-src 是个fallback选项，当没有指定具体执行的内容类型，则应用全部类型。\n可以通过设置具体类型来覆盖。")]),t._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[t._v("Content-Security-Policy: default-src 'self'; script-src https://example.com\n")])])]),r("p",[t._v("将与以下内容相同：")]),t._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[t._v("Content-Security-Policy: connect-src 'self'; \n                         font-src 'self'; \n                         frame-src 'self'; \n                         img-src 'self'; \n                         manifest-src 'self'; \n                         media-src 'self'; \n                         object-src 'self'; \n                         script-src https://example.com; \n                         style-src 'self'; \n                         worker-src 'self'\n")])])])])}),[],!1,null,null,null);s.default=e.exports}}]);