<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>一个方法团灭股票买卖问题 | 前端知识</title>
    <meta name="generator" content="VuePress 1.7.1">
    
    <meta name="description" content="主要记录自己对前端知识的梳理和理解。">
    
    <link rel="preload" href="/frontend-knowledge/assets/css/0.styles.1d57cce0.css" as="style"><link rel="preload" href="/frontend-knowledge/assets/js/app.eff64ccb.js" as="script"><link rel="preload" href="/frontend-knowledge/assets/js/2.782e60b8.js" as="script"><link rel="preload" href="/frontend-knowledge/assets/js/223.207e3712.js" as="script"><link rel="prefetch" href="/frontend-knowledge/assets/js/10.3d9a111f.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/100.b72e1dd7.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/101.668eb126.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/102.fb7907d8.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/103.7c6e7526.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/104.6f8b7665.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/105.86682443.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/106.f70dae0c.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/107.0ae4c3fc.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/108.53126485.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/109.bd24459f.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/11.dd62c4a8.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/110.bb069370.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/111.048c9a2b.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/112.e999d853.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/113.7cb36009.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/114.883061ee.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/115.df99ff7e.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/116.e24c9ba9.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/117.0dae1e9b.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/118.f9415e2f.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/119.43a2c61d.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/12.e23687cf.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/120.c04fb355.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/121.1df3cb60.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/122.3affd86b.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/123.383c14ec.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/124.0a299709.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/125.2e8efeb5.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/126.091b015b.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/127.a03773cd.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/128.7efcb75e.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/129.d7116cc0.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/13.de79bccd.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/130.2678f1c5.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/131.cd1ea8b5.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/132.1b43ad1a.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/133.20fc08db.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/134.7b0ca44d.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/135.da6f643e.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/136.ab80f2ce.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/137.e4e94ac8.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/138.0170b901.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/139.be04efd2.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/14.6f94c90a.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/140.2c3f155c.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/141.f02a20af.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/142.13853970.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/143.282c8dd5.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/144.b143eb4f.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/145.56016859.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/146.88698a7a.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/147.2e9adf6e.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/148.db92e23d.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/149.20bc720f.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/15.7ba256fa.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/150.3aa73038.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/151.1c3831e0.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/152.73e33893.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/153.8c366d51.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/154.886346c3.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/155.a6647b20.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/156.2de8309b.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/157.f5859b9a.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/158.7a6ef89f.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/159.d8b77f48.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/16.f8890531.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/160.7944a500.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/161.6e8ed3a0.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/162.bef8919a.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/163.92ad075f.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/164.5bfb1fb6.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/165.e6e2b90e.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/166.767cb73d.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/167.3bd7f1f8.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/168.c2a546dd.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/169.c9510041.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/17.ef939e55.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/170.2b89b01a.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/171.8ecc6ec3.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/172.8894952c.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/173.9f51c2db.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/174.3fab2cad.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/175.cec931bb.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/176.e3302559.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/177.57cb7998.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/178.16a09653.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/179.7644ecee.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/18.4ba3a2c7.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/180.5db88115.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/181.7bf2a6fd.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/182.bd3f8aeb.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/183.b5854046.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/184.ed856cc5.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/185.f0d5b5c1.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/186.012f5035.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/187.2ca209ed.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/188.0b2e8f55.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/189.f2aeff24.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/19.915b4fc8.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/190.27b6f802.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/191.6b9e6115.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/192.db3146bd.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/193.b094e26a.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/194.62223734.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/195.0102de4f.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/196.d2532598.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/197.fe328766.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/198.558873a8.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/199.74b9952c.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/20.0f7dde45.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/200.355209ac.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/201.deec37bf.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/202.2c2fdbd6.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/203.20b66a14.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/204.ae79f1a7.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/205.408bde6b.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/206.6da3a186.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/207.ba6bf118.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/208.5b396d70.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/209.4394de0c.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/21.30c8e9d9.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/210.247c1b01.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/211.fadc474d.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/212.cf215acc.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/213.c0bb331a.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/214.cd1d1593.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/215.5b0cdf91.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/216.a4055bd4.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/217.39660abd.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/218.434f8b5c.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/219.3e261912.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/22.2b3e83fd.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/220.a3f45a01.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/221.09892480.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/222.91231e79.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/224.47865323.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/225.52a699a6.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/226.9328010d.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/227.381ae298.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/228.c5518fa0.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/229.d1b97a0a.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/23.dcf23bf0.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/230.478fbfa7.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/231.9bb9b599.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/232.b7f51a66.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/233.1b52c4c5.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/234.d3d9cf60.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/235.ad575575.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/236.e77da1b5.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/237.4b1e6b51.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/238.10850ee7.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/239.a82b7636.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/24.d888a0cf.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/240.4d2c3c2c.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/241.0e0f1b8a.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/242.1d7f21e1.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/243.e7a7ea68.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/244.fa2f27de.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/245.5a251855.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/246.94512ff2.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/247.c42675a7.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/248.21665ced.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/249.05c3a9a8.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/25.4b695acd.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/250.b02debe5.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/251.c79d130c.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/252.a42f5db4.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/253.a7377e48.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/254.b1f2e61f.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/255.e804d551.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/256.12a55719.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/257.72ad4749.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/258.d7074bd2.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/259.985a53ac.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/26.7faef3c4.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/260.62c4030a.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/261.f010a32e.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/27.79f8f444.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/28.8b4faaa4.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/29.8e9bf5b1.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/3.df08e61c.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/30.eeb87601.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/31.1d28dbed.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/32.284e2ba9.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/33.cd6daae8.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/34.dedd731b.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/35.1681c2fb.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/36.72138b28.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/37.1f25edc6.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/38.b09b4505.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/39.0c6661f8.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/4.0d139cbc.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/40.a3483380.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/41.00db192d.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/42.6689aa92.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/43.3e53739e.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/44.aac58118.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/45.e0e988d8.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/46.db0c12d4.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/47.6febe170.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/48.4960bae2.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/49.a2e67da4.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/5.f65fcced.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/50.36d27a2f.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/51.6caef16d.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/52.3df104d1.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/53.eab9b56c.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/54.53013202.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/55.b3030c5b.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/56.01c5e567.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/57.807f3a73.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/58.97c23b78.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/59.692664ae.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/6.46d458e0.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/60.bfafb532.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/61.397ee182.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/62.437969a6.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/63.1d90fd9b.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/64.ccca388d.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/65.f7b7d373.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/66.fec5385c.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/67.226ab3c6.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/68.c1603afc.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/69.d20b6c1c.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/7.e80914fc.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/70.1df3cf64.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/71.c2555b17.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/72.4ec073b9.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/73.d5a8ad9f.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/74.a4a6c1dc.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/75.8cf01f9c.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/76.7a9434e7.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/77.3c712203.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/78.651d6f6c.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/79.5d3aa62d.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/8.fc4b649d.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/80.9f9b69ff.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/81.a909395a.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/82.90ee8cd0.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/83.6d25002e.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/84.a1feadcf.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/85.0e674436.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/86.c2af9e67.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/87.87946397.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/88.858a0871.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/89.18f38849.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/9.31fc3619.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/90.f141cfe9.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/91.262a3998.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/92.df862ca1.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/93.55f41186.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/94.07028f73.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/95.a0663d3d.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/96.d67d4efc.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/97.1bde2381.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/98.87c846d6.js"><link rel="prefetch" href="/frontend-knowledge/assets/js/99.2a3120c8.js">
    <link rel="stylesheet" href="/frontend-knowledge/assets/css/0.styles.1d57cce0.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/frontend-knowledge/" class="home-link router-link-active"><!----> <span class="site-name">前端知识</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://github.com/chuckbass2121/frontend-knowledge" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://github.com/chuckbass2121/frontend-knowledge" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>CSS</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>JavaScript</span> <span class="arrow right"></span></p> <!----></section></li><li><a href="/frontend-knowledge/" aria-current="page" class="sidebar-link">README.md</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>TypeScript</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>安全</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>实践篇</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>性能优化</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>手写代码</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>框架</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>模块化</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>浏览器渲染</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>真题</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>算法</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/frontend-knowledge/%E7%AE%97%E6%B3%95/" aria-current="page" class="sidebar-link">README.md</a></li><li><a href="/frontend-knowledge/算法/二分法.html" class="sidebar-link">二分法.md</a></li><li><a href="/frontend-knowledge/算法/二叉树.html" class="sidebar-link">二叉树.md</a></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading open"><span>刷题套路</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-2"><p class="sidebar-heading"><span>动态规划系列</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-2"><p class="sidebar-heading"><span>数据结构系列</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-2"><p class="sidebar-heading open"><span>第零章、必读系列</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/frontend-knowledge/算法/刷题套路/第零章、必读系列/BFS算法解题套路框架.html" class="sidebar-link">BFS算法解题套路框架.md</a></li><li><a href="/frontend-knowledge/算法/刷题套路/第零章、必读系列/一个方法团灭股票买卖问题.html" class="active sidebar-link">一个方法团灭股票买卖问题.md</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/frontend-knowledge/算法/刷题套路/第零章、必读系列/一个方法团灭股票买卖问题.html#穷举框架" class="sidebar-link">穷举框架</a></li><li class="sidebar-sub-header"><a href="/frontend-knowledge/算法/刷题套路/第零章、必读系列/一个方法团灭股票买卖问题.html#状态转移框架" class="sidebar-link">状态转移框架</a></li><li class="sidebar-sub-header"><a href="/frontend-knowledge/算法/刷题套路/第零章、必读系列/一个方法团灭股票买卖问题.html#秒杀题目" class="sidebar-link">秒杀题目</a></li><li class="sidebar-sub-header"><a href="/frontend-knowledge/算法/刷题套路/第零章、必读系列/一个方法团灭股票买卖问题.html#总结" class="sidebar-link">总结</a></li></ul></li><li><a href="/frontend-knowledge/算法/刷题套路/第零章、必读系列/一首诗让你把滑动窗口算法变成默写题.html" class="sidebar-link">一首诗让你把滑动窗口算法变成默写题.md</a></li><li><a href="/frontend-knowledge/算法/刷题套路/第零章、必读系列/一首诗让你闭着眼睛也能写对二分搜索.html" class="sidebar-link">一首诗让你闭着眼睛也能写对二分搜索.md</a></li><li><a href="/frontend-knowledge/算法/刷题套路/第零章、必读系列/动态规划题解套路框架.html" class="sidebar-link">动态规划题解套路框架.md</a></li><li><a href="/frontend-knowledge/算法/刷题套路/第零章、必读系列/回溯算法解题套路框架.html" class="sidebar-link">回溯算法解题套路框架.md</a></li><li><a href="/frontend-knowledge/算法/刷题套路/第零章、必读系列/学习算法和刷题的框架思维.html" class="sidebar-link">学习算法和刷题的框架思维.md</a></li><li><a href="/frontend-knowledge/算法/刷题套路/第零章、必读系列/教你几招算法笔试题的套路.html" class="sidebar-link">教你几招算法笔试题的套路.md</a></li><li><a href="/frontend-knowledge/算法/刷题套路/第零章、必读系列/经典动态规划：子集背包问题.html" class="sidebar-link">经典动态规划：子集背包问题.md</a></li></ul></section></li></ul></section></li><li><a href="/frontend-knowledge/算法/动态规划.html" class="sidebar-link">动态规划.md</a></li><li><a href="/frontend-knowledge/算法/双指针.html" class="sidebar-link">双指针.md</a></li><li><a href="/frontend-knowledge/算法/哈希表.html" class="sidebar-link">哈希表.md</a></li><li><a href="/frontend-knowledge/算法/回溯算法.html" class="sidebar-link">回溯算法.md</a></li><li><a href="/frontend-knowledge/算法/复杂度.html" class="sidebar-link">复杂度.md</a></li><li><a href="/frontend-knowledge/算法/字符串.html" class="sidebar-link">字符串.md</a></li><li><a href="/frontend-knowledge/算法/并查集.html" class="sidebar-link">并查集.md</a></li><li><a href="/frontend-knowledge/算法/排序算法.html" class="sidebar-link">排序算法.md</a></li><li><a href="/frontend-knowledge/算法/栈和队列.html" class="sidebar-link">栈和队列.md</a></li><li><a href="/frontend-knowledge/算法/矩阵.html" class="sidebar-link">矩阵.md</a></li><li><a href="/frontend-knowledge/算法/贪心算法.html" class="sidebar-link">贪心算法.md</a></li><li><a href="/frontend-knowledge/算法/链表.html" class="sidebar-link">链表.md</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>网络</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>计算机基础</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>错误监控</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="一个方法团灭股票买卖问题"><a href="#一个方法团灭股票买卖问题" class="header-anchor">#</a> 一个方法团灭股票买卖问题</h1> <p>股票买卖问题归根到底就是状态机问题，实际上就是 DP table。</p> <p>LeetCode 中一共有 6 题股票买卖问题，其中第 4 题时最泛化的一题，其他问题都是这个形式的简化，看下题目：</p> <p><img src="https://gblobscdn.gitbook.com/assets%2F-LrtQOWSnDdXhp3kYN4k%2Fsync%2Ff2f977954117e3643323d2eac4c3668f502835d1.png?alt=media" alt="img"></p> <p>第一题是指进行一次交易，即 <code>k = 1</code> ；第二题是不限交易次数，即 <code>k = Infinity</code> ；第三题是指进行 2 次交易，即 <code>k = 2</code> ；剩下两道题也是不限次数，但是加了交易「冷冻期」和「手续费」的额外条件，其实就是第二题的变种。</p> <h2 id="穷举框架"><a href="#穷举框架" class="header-anchor">#</a> 穷举框架</h2> <p>首先还是一样的思路：如何穷举？这里的穷举和之前的递归思想不太一样。</p> <p>递归其实是符合我们思考的逻辑，一步步推进，遇到无法解决的问题就丢给递归，一不小心就做出来了，可读性很好，缺点是一旦出错非常难定位到具体位置。</p> <p>而这里我们不用递归思想进行穷举，而是利用「状态」进行穷举。我们具体到每一天，看看总共有几种可能的「状态」，再找出每个「状态」对应的「选择」。我们要穷举所有「状态」，穷举的目的是根据对应的「选择」更新状态。听起来抽象，你只要记住「状态」和「选择」两个词就行，下面是操一下就很容易明白了。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">for</span> 状态<span class="token number">1</span> <span class="token keyword">in</span> 状态<span class="token number">1</span>的所有取值：
    <span class="token keyword">for</span> 状态<span class="token number">2</span> <span class="token keyword">in</span> 状态<span class="token number">2</span>的所有取值：
        <span class="token keyword">for</span> <span class="token operator">...</span>
            dp<span class="token punctuation">[</span>状态<span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>状态<span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token operator">...</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">择优</span><span class="token punctuation">(</span>选择<span class="token number">1</span>，选择<span class="token number">2.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
</code></pre></div><p>比如说这个问题， <strong>每天都有三种「选择」</strong> ：买入、卖出、无操作，我们用 buy，sell，rest 来表示。但问题是，并不是每天都可与任意选择这三种选择，因为 sell 必须在 bug 之后，bug 必须在 sell 之后。那么 rest 操作还应该分两种状态，一种是 bug 之后的 rest（持有了股票），一种是 sell 之后的 rest（没有持有股票）。而且别忘了，我们还有交易次数 k 的限制，就是说你 bug 还只能在 <code>k &gt; 0</code> 的前提下操作。</p> <p>很复杂对吧，不要怕，我们现在的目的只是穷举，你有再多的状态，我们直接全部列举出来。这个问题的「状态」有三个，第一个是天数，第二个是允许交易的最大次数，第三个是当前的持有状态（即之前说的 rest 状态，不妨用 1 表示持有，用 0 表示未持有）。然后我们用一个三维数组就可以装下这种状态的全部组合。</p> <div class="language-js extra-class"><pre class="language-js"><code>dp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span> or <span class="token number">1</span><span class="token punctuation">]</span>
<span class="token number">0</span> <span class="token operator">&lt;=</span> i <span class="token operator">&lt;=</span> n<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span> <span class="token operator">&lt;=</span> k <span class="token operator">&lt;=</span> <span class="token constant">K</span>
n 为天数，大 <span class="token constant">K</span> 为最多交易数
此问题共 n × <span class="token constant">K</span> × <span class="token number">2</span> 种状态，全部穷举就能搞定。

<span class="token keyword">for</span> <span class="token number">0</span> <span class="token operator">&lt;=</span> i <span class="token operator">&lt;</span> n<span class="token operator">:</span>
    <span class="token keyword">for</span> <span class="token number">1</span> <span class="token operator">&lt;=</span> k <span class="token operator">&lt;=</span> <span class="token constant">K</span><span class="token operator">:</span>
        <span class="token keyword">for</span> s <span class="token keyword">in</span> <span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token operator">:</span>
            dp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">[</span>s<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">max</span><span class="token punctuation">(</span>buy<span class="token punctuation">,</span> sell<span class="token punctuation">,</span> rest<span class="token punctuation">)</span>
</code></pre></div><p>而且我们可以用自然语言描述出每一个状态的含义，比如说 <code>dp[3][2][1]</code> 的含义就是：今天是第三天，我现在手上持有着股票，至今最多进行 2 次交易。再比如 <code>dp[2][3][0]</code> 的含义：今天是第二天，我现在手上没有持有股票，至今最多进行 3 次交易。很容易理解，对吧？</p> <p>我们想求的最终答案是 <code>dp[n - 1][K][0]</code>，即最后一天，最多允许 K 次交易，最多获得多少利润。读者可能问为什么不是 <code>dp[n - 1][K][1]</code> ？因为 [1] 代表手上还持有股票，[0] 表示手上的股票已经卖出去了，很显然后者得到的利润一定大于前者。</p> <h2 id="状态转移框架"><a href="#状态转移框架" class="header-anchor">#</a> 状态转移框架</h2> <p>现在我们完成了「状态」的穷举，我们开始思考每种「状态」有哪些「选择」，应该如何更新「状态」。只看「持有状态」，可以画个状态转移图。</p> <p><img src="https://gblobscdn.gitbook.com/assets%2F-LrtQOWSnDdXhp3kYN4k%2Fsync%2F298b4971971d6e850923f64ab74792b86aa5c668.png?alt=media" alt="img"></p> <p>通过这个图可以很清楚地看到，每种状态（0 和 1）是如何转移而来的。根据这个图，我们来写一下状态转移方程：</p> <div class="language- extra-class"><pre class="language-text"><code>dp[i][k][0] = max(dp[i-1][k][0], dp[i-1][k][1] + prices[i])
              max(   选择 rest  ,             选择 sell      )


解释：今天我没有持有股票，有两种可能：
要么是我昨天就没有持有，然后今天选择 rest，所以我今天还是没有持有；
要么是我昨天持有股票，但是今天我 sell 了，所以我今天没有持有股票了。


dp[i][k][1] = max(dp[i-1][k][1], dp[i-1][k-1][0] - prices[i])
              max(   选择 rest  ,           选择 buy         )


解释：今天我持有着股票，有两种可能：
要么我昨天就持有着股票，然后今天选择 rest，所以我今天还持有着股票；
要么我昨天本没有持有，但今天我选择 buy，所以今天我就持有股票了。
</code></pre></div><p>这个解释应该很清楚了，如果 buy，就要从利润中减去 prices[i]，如果 sell，就要给利润增加 prices[i]。今天的最大利润就是这两种可能选择中较大的那个。而且注意 k 的限制，我们在选择 buy 的时候，把 k 减小了 1，很好理解吧，当然你也可以在 sell 的时候减 1，一样的。</p> <p>现在，我们已经完成了动态规划中最困难的一步：状态转移方程。**如果之前的内容你都可以理解，那么你已经可以秒杀所有问题了，只要套这个框架就行了。**不过还差最后一点点，就是定义 base case，即最简单的情况。</p> <div class="language- extra-class"><pre class="language-text"><code>dp[-1][k][0] = 0
解释：因为 i 是从 0 开始的，所以 i = -1 意味着还没有开始，这时候的利润当然是 0 。
dp[-1][k][1] = -infinity
解释：还没开始的时候，是不可能持有股票的，用负无穷表示这种不可能。
dp[i][0][0] = 0
解释：因为 k 是从 1 开始的，所以 k = 0 意味着根本不允许交易，这时候利润当然是 0 。
dp[i][0][1] = -infinity
解释：不允许交易的情况下，是不可能持有股票的，用负无穷表示这种不可能。
</code></pre></div><p>把上面的状态转移方程总结一下：</p> <div class="language- extra-class"><pre class="language-text"><code>base case：
dp[-1][k][0] = dp[i][0][0] = 0
dp[-1][k][1] = dp[i][0][1] = -infinity


状态转移方程：
dp[i][k][0] = max(dp[i-1][k][0], dp[i-1][k][1] + prices[i])
dp[i][k][1] = max(dp[i-1][k][1], dp[i-1][k-1][0] - prices[i])
</code></pre></div><p>读者可能会问，这个数组索引是 -1 怎么编程表示出来呢，负无穷怎么表示呢？这都是细节问题，有很多方法实现。现在完整的框架已经完成，下面开始具体化。</p> <h2 id="秒杀题目"><a href="#秒杀题目" class="header-anchor">#</a> 秒杀题目</h2> <h3 id="第一题-k-1"><a href="#第一题-k-1" class="header-anchor">#</a> 第一题， <code>k = 1</code></h3> <p>直接套状态转移方程，根据 base case，可以做一些化简：</p> <div class="language- extra-class"><pre class="language-text"><code>dp[i][1][0] = max(dp[i-1][1][0], dp[i-1][1][1] + prices[i])
dp[i][1][1] = max(dp[i-1][1][1], dp[i-1][0][0] - prices[i]) 
            = max(dp[i-1][1][1], -prices[i])
解释：k = 0 的 base case，所以 dp[i-1][0][0] = 0。


现在发现 k 都是 1，不会改变，即 k 对状态转移已经没有影响了。
可以进行进一步化简去掉所有 k：
dp[i][0] = max(dp[i-1][0], dp[i-1][1] + prices[i])
dp[i][1] = max(dp[i-1][1], -prices[i])
</code></pre></div><p>直接写出代码：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">int</span> n <span class="token operator">=</span> prices<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
<span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> dp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    dp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>dp<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dp<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> prices<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    dp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>dp<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token operator">-</span>prices<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">return</span> dp<span class="token punctuation">[</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><p>显然 i = 0 时 dp[i-1] 是不合法的。这是因为我们没有对 i 的 base case 进行处理。可以这样处理：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        dp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token comment">// 解释：</span>
        <span class="token comment">//   dp[i][0] </span>
        <span class="token comment">// = max(dp[-1][0], dp[-1][1] + prices[i])</span>
        <span class="token comment">// = max(0, -infinity + prices[i]) = 0</span>
        dp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">-</span>prices<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token comment">//解释：</span>
        <span class="token comment">//   dp[i][1] </span>
        <span class="token comment">// = max(dp[-1][1], dp[-1][0] - prices[i])</span>
        <span class="token comment">// = max(-infinity, 0 - prices[i]) </span>
        <span class="token comment">// = -prices[i]</span>
        <span class="token keyword">continue</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    dp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>dp<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dp<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> prices<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    dp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>dp<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token operator">-</span>prices<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">return</span> dp<span class="token punctuation">[</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><p>第一题就解决了，但是这样处理 base case 很麻烦，而且注意一下状态转移方程，新状态只和相邻的一个状态有关，其实不用整个 dp 数组，只需要一个变量储存相邻的那个状态就足够了，这样可以把空间复杂度降到 O(1):</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// k == 1</span>
<span class="token keyword">int</span> <span class="token function">maxProfit_k_1</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> prices<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> n <span class="token operator">=</span> prices<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
    <span class="token comment">// base case: dp[-1][0] = 0, dp[-1][1] = -infinity</span>
    <span class="token keyword">int</span> dp_i_0 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> dp_i_1 <span class="token operator">=</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span>MIN_VALUE<span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// dp[i][0] = max(dp[i-1][0], dp[i-1][1] + prices[i])</span>
        dp_i_0 <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>dp_i_0<span class="token punctuation">,</span> dp_i_1 <span class="token operator">+</span> prices<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// dp[i][1] = max(dp[i-1][1], -prices[i])</span>
        dp_i_1 <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>dp_i_1<span class="token punctuation">,</span> <span class="token operator">-</span>prices<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> dp_i_0<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>两种方式都是一样的，不过这种编程方法简洁很多。但是如果没有前面状态转移方程的引导，是肯定看不懂的。后续的题目，我主要写这种空间复杂度 O(1) 的解法。</p> <h3 id="第二题-k-infinity"><a href="#第二题-k-infinity" class="header-anchor">#</a> 第二题，<code>k = Infinity</code></h3> <p>如果 k 为正无穷，那么就可以认为 k 和 k - 1 是一样的。可以这样改写框架：</p> <div class="language- extra-class"><pre class="language-text"><code>dp[i][k][0] = max(dp[i-1][k][0], dp[i-1][k][1] + prices[i])
dp[i][k][1] = max(dp[i-1][k][1], dp[i-1][k-1][0] - prices[i])
            = max(dp[i-1][k][1], dp[i-1][k][0] - prices[i])


我们发现数组中的 k 已经不会改变了，也就是说不需要记录 k 这个状态了：
dp[i][0] = max(dp[i-1][0], dp[i-1][1] + prices[i])
dp[i][1] = max(dp[i-1][1], dp[i-1][0] - prices[i])
</code></pre></div><p>直接翻译成代码：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">int</span> <span class="token function">maxProfit_k_inf</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> prices<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> n <span class="token operator">=</span> prices<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
    <span class="token keyword">int</span> dp_i_0 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> dp_i_1 <span class="token operator">=</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span>MIN_VALUE<span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span> temp <span class="token operator">=</span> dp_i_0<span class="token punctuation">;</span>
        dp_i_0 <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>dp_i_0<span class="token punctuation">,</span> dp_i_1 <span class="token operator">+</span> prices<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        dp_i_1 <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>dp_i_1<span class="token punctuation">,</span> temp <span class="token operator">-</span> prices<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> dp_i_0<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="第三题-k-infinity-含有「冷冻期」"><a href="#第三题-k-infinity-含有「冷冻期」" class="header-anchor">#</a> 第三题，<code>k = Infinity</code> 含有「冷冻期」</h3> <p>每次 sell 之后要等一天才能继续交易。只要把这个特点融入上一题的状态转移方程即可：</p> <div class="language- extra-class"><pre class="language-text"><code>dp[i][0] = max(dp[i-1][0], dp[i-1][1] + prices[i])
dp[i][1] = max(dp[i-1][1], dp[i-2][0] - prices[i])
解释：第 i 天选择 buy 的时候，要从 i-2 的状态转移，而不是 i-1 。
</code></pre></div><p>翻译成代码：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">int</span> <span class="token function">maxProfit_with_cool</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> prices<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> n <span class="token operator">=</span> prices<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
    <span class="token keyword">int</span> dp_i_0 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> dp_i_1 <span class="token operator">=</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span>MIN_VALUE<span class="token punctuation">;</span>
    <span class="token keyword">int</span> dp_pre_0 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">// 代表 dp[i-2][0]</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span> temp <span class="token operator">=</span> dp_i_0<span class="token punctuation">;</span>
        dp_i_0 <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>dp_i_0<span class="token punctuation">,</span> dp_i_1 <span class="token operator">+</span> prices<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        dp_i_1 <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>dp_i_1<span class="token punctuation">,</span> dp_pre_0 <span class="token operator">-</span> prices<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        dp_pre_0 <span class="token operator">=</span> temp<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> dp_i_0<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="第四题-k-infinity-包含手续费"><a href="#第四题-k-infinity-包含手续费" class="header-anchor">#</a> 第四题，<code>k = Infinity</code> 包含手续费</h3> <p>每次交易要支付手续费，只要把手续费从利润中减去即可。改写方程：</p> <div class="language- extra-class"><pre class="language-text"><code>dp[i][0] = max(dp[i-1][0], dp[i-1][1] + prices[i])
dp[i][1] = max(dp[i-1][1], dp[i-1][0] - prices[i] - fee)
解释：相当于买入股票的价格升高了。
在第一个式子里减也是一样的，相当于卖出股票的价格减小了。
</code></pre></div><p>直接翻译成代码：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">int</span> <span class="token function">maxProfit_with_fee</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> prices<span class="token punctuation">,</span> <span class="token keyword">int</span> fee<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> n <span class="token operator">=</span> prices<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
    <span class="token keyword">int</span> dp_i_0 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> dp_i_1 <span class="token operator">=</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span>MIN_VALUE<span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span> temp <span class="token operator">=</span> dp_i_0<span class="token punctuation">;</span>
        dp_i_0 <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>dp_i_0<span class="token punctuation">,</span> dp_i_1 <span class="token operator">+</span> prices<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        dp_i_1 <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>dp_i_1<span class="token punctuation">,</span> temp <span class="token operator">-</span> prices<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> fee<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> dp_i_0<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="第五题-k-2"><a href="#第五题-k-2" class="header-anchor">#</a> 第五题，<code>k = 2</code></h3> <p>k = 2 和前面题目的情况稍微不同，因为上面的情况都和 k 的关系不太大。要么 k 是正无穷，状态转移和 k 没关系了；要么 k = 1，跟 k = 0 这个 base case 挨得近，最后也没有存在感。</p> <p>这道题 k = 2 和后面要讲的 k 是任意正整数的情况中，对 k 的处理就凸显出来了。我们直接写代码，边写边分析原因。</p> <div class="language- extra-class"><pre class="language-text"><code>原始的动态转移方程，没有可化简的地方
dp[i][k][0] = max(dp[i-1][k][0], dp[i-1][k][1] + prices[i])
dp[i][k][1] = max(dp[i-1][k][1], dp[i-1][k-1][0] - prices[i])
</code></pre></div><p>按照之前的代码，我们可能想当然这样写代码（错误的）：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">int</span> k <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
<span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> dp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">[</span>k <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">/* 处理一下 base case*/</span> <span class="token punctuation">}</span>
    dp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>dp<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dp<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> prices<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    dp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>dp<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dp<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">-</span> prices<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">return</span> dp<span class="token punctuation">[</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><p>为什么错误？我这不是照着状态转移方程写的吗？</p> <p>还记得前面总结的「穷举框架」吗？就是说我们必须穷举所有状态。其实我们之前的解法，都在穷举所有状态，只是之前的题目中 k 都被化简掉了。比如说第一题，k = 1：</p> <p>「代码截图」</p> <p>这道题由于没有消掉 k 的影响，所以必须要对 k 进行穷举：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">int</span> max_k <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
<span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> dp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">[</span>max_k <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> k <span class="token operator">=</span> max_k<span class="token punctuation">;</span> k <span class="token operator">&gt;=</span> <span class="token number">1</span><span class="token punctuation">;</span> k<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">/*处理 base case */</span> <span class="token punctuation">}</span>
        dp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">max</span><span class="token punctuation">(</span>dp<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dp<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> prices<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        dp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">max</span><span class="token punctuation">(</span>dp<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dp<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">-</span> prices<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// 穷举了 n × max_k × 2 个状态，正确。</span>
<span class="token keyword">return</span> dp<span class="token punctuation">[</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>max_k<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><p>如果你不理解，可以返回第一点「穷举框架」重新阅读体会一下。</p> <p>这里 k 取值范围比较小，所以可以不用 for 循环，直接把 k = 1 和 2 的情况全部列举出来也可以：</p> <div class="language-java extra-class"><pre class="language-java"><code>dp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">max</span><span class="token punctuation">(</span>dp<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dp<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> prices<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
dp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">max</span><span class="token punctuation">(</span>dp<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dp<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">-</span> prices<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
dp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">max</span><span class="token punctuation">(</span>dp<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dp<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> prices<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
dp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">max</span><span class="token punctuation">(</span>dp<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token operator">-</span>prices<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>


<span class="token keyword">int</span> <span class="token function">maxProfit_k_2</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> prices<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> dp_i10 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> dp_i11 <span class="token operator">=</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span>MIN_VALUE<span class="token punctuation">;</span>
    <span class="token keyword">int</span> dp_i20 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> dp_i21 <span class="token operator">=</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span>MIN_VALUE<span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> price <span class="token operator">:</span> prices<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        dp_i20 <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>dp_i20<span class="token punctuation">,</span> dp_i21 <span class="token operator">+</span> price<span class="token punctuation">)</span><span class="token punctuation">;</span>
        dp_i21 <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>dp_i21<span class="token punctuation">,</span> dp_i10 <span class="token operator">-</span> price<span class="token punctuation">)</span><span class="token punctuation">;</span>
        dp_i10 <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>dp_i10<span class="token punctuation">,</span> dp_i11 <span class="token operator">+</span> price<span class="token punctuation">)</span><span class="token punctuation">;</span>
        dp_i11 <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>dp_i11<span class="token punctuation">,</span> <span class="token operator">-</span>price<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> dp_i20<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>有状态转移方程和含义明确的变量名指导，相信你很容易看懂。其实我们可以故弄玄虚，把上述四个变量换成 a, b, c, d。这样当别人看到你的代码时就会大惊失色，对你肃然起敬。</p> <h3 id="第六题-k-any-integer"><a href="#第六题-k-any-integer" class="header-anchor">#</a> 第六题， <code>k = any integer</code></h3> <p>有了上一题 k = 2 的铺垫，这题应该和上一题的第一个解法没啥区别。但是出现了一个超内存的错误，原来是传入的 k 值会非常大，dp 数组太大了。现在想想，交易次数 k 最多有多大呢？</p> <p>一次交易由买入和卖出构成，至少需要两天。所以说有效的限制 k 应该不超过 n/2，如果超过，就没有约束作用了，相当于 k = +infinity。这种情况是之前解决过的。</p> <p>直接把之前的代码重用：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">int</span> <span class="token function">maxProfit_k_any</span><span class="token punctuation">(</span><span class="token keyword">int</span> max_k<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> prices<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> n <span class="token operator">=</span> prices<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>max_k <span class="token operator">&gt;</span> n <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span> 
        <span class="token keyword">return</span> <span class="token function">maxProfit_k_inf</span><span class="token punctuation">(</span>prices<span class="token punctuation">)</span><span class="token punctuation">;</span>


    <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> dp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">[</span>max_k <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> 
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> k <span class="token operator">=</span> max_k<span class="token punctuation">;</span> k <span class="token operator">&gt;=</span> <span class="token number">1</span><span class="token punctuation">;</span> k<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">/* 处理 base case */</span> <span class="token punctuation">}</span>
            dp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">max</span><span class="token punctuation">(</span>dp<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dp<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> prices<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            dp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">max</span><span class="token punctuation">(</span>dp<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dp<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">-</span> prices<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     
        <span class="token punctuation">}</span>
    <span class="token keyword">return</span> dp<span class="token punctuation">[</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>max_k<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>至此，6 道题目通过一个状态转移方程全部解决。</p> <h2 id="总结"><a href="#总结" class="header-anchor">#</a> 总结</h2> <p>本文给大家讲了如何通过状态转移的方法解决复杂的问题，用一个状态转移方程秒杀了 6 道股票买卖问题，现在想想，其实也不算难对吧？这已经属于动态规划问题中较困难的了。</p> <p>关键就在于列举出所有可能的「状态」，然后想想怎么穷举更新这些「状态」。一般用一个多维 dp 数组储存这些状态，从 base case 开始向后推进，推进到最后的状态，就是我们想要的答案。想想这个过程，你是不是有点理解「动态规划」这个名词的意义了呢？</p> <p>具体到股票买卖问题，我们发现了三个状态，使用了一个三维数组，无非还是穷举 + 更新，不过我们可以说的高大上一点，这叫「三维 DP」。</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/frontend-knowledge/算法/刷题套路/第零章、必读系列/BFS算法解题套路框架.html" class="prev">
        BFS算法解题套路框架.md
      </a></span> <span class="next"><a href="/frontend-knowledge/算法/刷题套路/第零章、必读系列/一首诗让你把滑动窗口算法变成默写题.html">
        一首诗让你把滑动窗口算法变成默写题.md
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/frontend-knowledge/assets/js/app.eff64ccb.js" defer></script><script src="/frontend-knowledge/assets/js/2.782e60b8.js" defer></script><script src="/frontend-knowledge/assets/js/223.207e3712.js" defer></script>
  </body>
</html>
